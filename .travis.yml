sudo: required
services:
- docker
language: python
python:
- '3.5'
before_install:
- docker version
- docker info
install:
- npm install newman
- pip install -r requirements.txt
- pip install nose
- pip install Flask-Testing
before_script:
- node --version
- npm --version
- node_modules/.bin/newman --version
script:
- docker build -t besteinert/devops:swagger_server .
- docker run --name bennys_api -d -t -p 127.0.0.1:8080:8080 besteinert/devops:swagger_server
- docker ps
- count=0 && until $(curl --output /dev/null --silent --head --fail http://localhost:8080);
  do printf '.' && sleep 3 && count=$((count+1)) && if [ $count -gt 5 ]; then break;
  fi; done
after_success:
- docker login -u $DOCKER_USER -p $DOCKER_PASS
- docker tag swagger_server besteinert/devops:swagger_server
- docker push besteinert/devops:swagger_server
env:
  global:
  - secure: R2yv5E2CHvFGEn33MJWPY1d+XQYvwqjHhZ6/2G8iba+uj7qL8h3fnw6prNZCgVEJ6Ll5xsRSY6b1/ZbuPscH3tc0icAnQ7rt9QOFmJH+ZcfoS5rrIqQOrVP81IKPGiXdbFFONF1AKUygbyszI4ukDr8ag+NRkUYwvhJPmaW+FnhkszupgkHe1MxVTJUstbBQULu+4b1MmyBi/YFpWg/fOLPiMAl57WtcSj2zDtl2rqUWHYteT4OdrzhJsrSXpFBMB1qltjqcwHDN1QPyHzfRzU+6cBzAI8PCkiBnhm1zLl7VNx/+SMe4X2nuTt4P154hzy9q6vPbi/Q5XkDL/iRnDx8gWpg4VgtgSVXSLytI6FVo5SymBspATQcTxzYUP+chhqw4dom958Es9WggIQPvriPP4m+qBytw1LrqtG72pEOaIZ33hfHUL85FhwZOHz94tb1ma8/Xfl+NRo4Hc4+17P0mzZ9lFCEDmGNCqXP0p2FKt1M4Uc8tVAqMB0QGdCdWb35lOmSK7QQKOJXau9ADzD4PQEk9Xs6Zlr3mRNOnHXEdLc1GvP6v6SieDGOyBQ6Vq/qgp5ZjjcPQtzZWbGDmLJLTfjMPUuNDHLtMjFA43qri4Rob7jJGx41hqmbNSLUuDBBt0u6GZad7yymXXKj9nYVJRJyN+sF0Z68N/CB2ge4=
  - secure: fdKq++hSBfDx04Gbz/vxr1ArV1iTz3I2/ibrKsjx5+2M42TGsGsr5PIZxaiWro2BfZRCc3B3dSSqiubNFRoA3Zf+cvyTUMcX9dxGRpcfo7JXNsA0P9utCs1cOI/lhhSI7f3xToatpZ6/7HufkVPVXplR1GxyrErmKdhsd+gJC1xYg4PS1/C8tGYS8PvvXoGn9kvdVAFCUz04LWv6tkPZoMwHwQCWMzwEjZ+/c8w3rTYSDeaDyWGdUOtWDYlMIeQaKf9qRueKT+5f/A+rXqOlAlI5adwaUt519Z2vDxZVfuzT6Paog9Lb8MFvwegEDj6wNe9XpiyWHwHBSW08/I4R7MddWGmJWtE/XynPAw/JvuV/U0GAx1+suXjDK0LGbxgmzqKpgUpayPvesx+399OO9f+YyvlUEZox6oqsCl4qu63QW/QZoXDtpqzmzXNn3gh1TrLpVj4EultT3BXnixOJW3RJ2YssEV5LfJ0r3xx4EErv2Sn2c/LcPibxYfg03Rr8N/9HhN7jtQxi+JpwXwEtQE1De90SCLJXq3/zifa7ry/HEU4KTV2EJrw8l/To3m+uAMv0CCOFCbj9Nl61MVAzGcTvrZVI+5cAxlQnf7Fx21714x3uCTgU6K3P+z0sZ5rOTT8YLafRWmQHZkde9xisA5LALHNxapTOu7IHUe6yz1c=
